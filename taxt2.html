<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<title>GAS POST 測試工具</title>
<style>
  body { font-family: sans-serif; margin: 20px; }
  button { margin: 6px; padding: 8px 12px; font-size: 16px; }
  pre { background: #f4f4f4; padding: 10px; white-space: pre-wrap; }
</style>
</head>
<body>
<h2>GAS POST 測試工具</h2>
<p>測試三種 POST 發送方式，直接看哪個能通過。</p>

<!-- 直接把你的 GAS URL 寫死在這裡 -->
<script>
const API_BASE = "https://script.google.com/macros/s/AKfycbz02U3mY1UTzWFJP6h0EkdTn3DZYAZRg5YnDWvFTncWV9CFibK6XDVj6gIxNx7ehNei/exec";

async function testJSON() {
  const payload = { action: "ping" };
  try {
    const res = await fetch(API_BASE, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(payload)
    });
    document.getElementById("result").textContent =
      "JSON 方式：" + (await res.text());
  } catch (e) {
    document.getElementById("result").textContent =
      "JSON 方式失敗：" + e;
  }
}

async function testForm() {
  const formData = new URLSearchParams();
  formData.append("action", "ping");
  try {
    const res = await fetch(API_BASE, {
      method: "POST",
      headers: { "Content-Type": "application/x-www-form-urlencoded" },
      body: formData
    });
    document.getElementById("result").textContent =
      "Form 方式：" + (await res.text());
  } catch (e) {
    document.getElementById("result").textContent =
      "Form 方式失敗：" + e;
  }
}

async function testPlain() {
  const payload = { action: "ping" };
  try {
    const res = await fetch(API_BASE, {
      method: "POST",
      headers: { "Content-Type": "text/plain" },
      body: JSON.stringify(payload)
    });
    document.getElementById("result").textContent =
      "Plain 方式：" + (await res.text());
  } catch (e) {
    document.getElementById("result").textContent =
      "Plain 方式失敗：" + e;
  }
}
</script>

<button onclick="testJSON()">測試 JSON (application/json)</button>
<button onclick="testForm()">測試 Form (x-www-form-urlencoded)</button>
<button onclick="testPlain()">測試 Plain (text/plain)</button>

<h3>回應結果</h3>
<pre id="result">請先點上方按鈕</pre>

</body>
</html>