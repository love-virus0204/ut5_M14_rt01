<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>RT å¤–è§€æŠ½é©—è¨˜éŒ„è¡¨</title>
<style>
  body { font-family: "Comic Sans MS", sans-serif; margin: 10px; }
  h1 { display: flex; justify-content: space-between; align-items: center; margin: 0 0 10px 0; }
  h1 span { font-family: "æ¨™æ¥·é«”", serif; font-weight: bold; }
  .top-row { display: flex; justify-content: space-between; margin-bottom: 10px; }
  .label { font-family: "æ¨™æ¥·é«”", serif; display: inline-block; width: 70px; text-align: center; }
  input, select, textarea {
    width: calc(100% - 90px);
    margin-bottom: 8px;
    padding: 5px;
    font-family: "Comic Sans MS", sans-serif;
  }
  textarea[readonly] { background-color: #f2f2f2; color: #555; }
  #sendBtn { display: block; margin-left: auto; margin-top: 10px; padding: 8px 20px; background: #007bff; color: white; border: none; border-radius: 5px; }
  hr { margin: 15px 0; }
  table { width: 100%; border-collapse: collapse; text-align: center; font-size: 14px; }
  th, td { border-top: 1px solid #ddd; padding: 5px; }
  .top-left { text-align: left; font-size: 14px; }
  .top-center { text-align: center; font-size: 16px; font-weight: bold; }
</style>
</head>
<body>
<h1>
  <span>ğŸŒ</span>
  <span>RT å¤–è§€æŠ½é©—è¨˜éŒ„è¡¨</span>
  <button id="backBtn" style="background:none;border:none;font-size:18px;">â†©ï¸</button>
</h1>

<div class="top-row">
  <div id="tsView" class="top-left"></div>
  <div id="dsView" class="top-center"></div>
</div>

<label class="label">æŠ½ é©—ï¼š</label><input type="text" id="inspector" placeholder="è¼¸å…¥ 5 ç¢¼å·¥è™Ÿ"><br>
<label class="label">æ–™ è™Ÿï¼š</label><input type="text" id="partNo" placeholder="è«‹è¼¸å…¥ æ–™è™Ÿ by 7ç¢¼"><br>
<label class="label">æ‰¹ è™Ÿï¼š</label>
<select id="lotPrefix" style="width:25%">
  <option value=""></option>
  <option value="FA">FA</option>
</select>
<input type="text" id="lotInput" placeholder="æ¯æ‰¹[-å­æ‰¹] (æ¯æ‰¹3ç¢¼è‹±æ•¸)" style="width:70%"><br>
<label class="label">æ•¸ é‡ï¼š</label><input type="number" id="qty" placeholder="è¼¸å…¥æ‰¹é‡"><br>
<label class="label">å‚™ è¨»ï¼š</label><textarea id="remark" readonly>ç›®å‰ä¸é–‹æ”¾è¼¸å…¥</textarea><br>

<button id="sendBtn">é€å‡º</button>

<hr>
<table>
  <thead>
    <tr><th>æ–™ è™Ÿ</th><th>æ‰¹ è™Ÿ</th><th>æ•¸ é‡</th></tr>
  </thead>
  <tbody id="recordList"></tbody>
</table>

<script>
const GAS_URL   = "https://script.google.com/macros/s/AKfycbw81dgU81h8rNAuwch_A3LrV5ZAox4RGHu-y8yHifuSzJALSOBn7AVFd9_ld0b_15LG/exec";
const API_TOKEN = "MY_SECRET_123";

document.getElementById('backBtn').onclick=()=>{ if(history.length>1) history.back(); };

function fmtLocal(d){
  const y=d.getFullYear(),m=String(d.getMonth()+1).padStart(2,'0'),day=String(d.getDate()).padStart(2,'0');
  const hh=String(d.getHours()).padStart(2,'0'),mm=String(d.getMinutes()).padStart(2,'0');
  return `${y}-${m}-${day} ${hh}:${mm}`;
}

function calcShift(){
  const now=new Date(), mins=now.getHours()*60+now.getMinutes();
  if(mins>=520 && mins<1000) return 'A';
  if(mins>=1000 || mins<40) return 'B';
  return 'C';
}

function tick(){
  const n=new Date();
  document.getElementById('tsView').textContent=fmtLocal(n);
  const md=`${String(n.getMonth()+1).padStart(2,'0')}/${String(n.getDate()).padStart(2,'0')}`;
  document.getElementById('dsView').textContent=`${md} - ${calcShift()}`;
}
tick();
setInterval(tick,30000);

</script>
</body>
</html>