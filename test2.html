<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>GAS 測試送出</title>
<style>
body{font-family:system-ui;margin:0;padding:20px;background:#fafafa}
button{font-size:20px;padding:12px 24px;border-radius:8px;border:1px solid #ccc;cursor:pointer}
pre{background:#000;color:#0f0;padding:8px;white-space:pre-wrap;margin-top:12px;border-radius:8px;font:12px ui-monospace,monospace;max-height:40vh;overflow:auto}
</style>
</head>
<body>
<h2>GAS 測試送出</h2>
<button id="testBtn">送出固定資料</button>
<pre id="log"></pre>

<script>
// 已填入你表單使用的完整 exec URL
const API_BASE="https://script.google.com/macros/s/AKfycbw81dgU8dU81h8rNAuwch_A3LrV5ZAox4RGHu-y8yHifuSzJALSOBn7AVFd9_ld0b_15LG/exec";

function log(msg){
  const el=document.getElementById("log");
  el.textContent+=msg+"\n";
}

async function testSend(){
  const payload={
    action:"submit",
    inspector:"TESTER",
    part_no:"A12B345",
    lot:"123",
    qty:"999",
    date:"2025/09/22",
    shift:"C",
    submitted_at:"2025/09/22 03:30:00",
    t:Date.now()
  };
  const url=API_BASE+"?"+new URLSearchParams(payload).toString();
  log("[URL] "+url);
  try{
    const r=await fetch(url,{method:"GET",cache:"no-store"});
    log("[HTTP] "+r.status);
    const txt=await r.text();
    log("[RESP] "+txt.slice(0,200));
  }catch(e){
    log("[ERR] "+(e&&e.message||e));
  }
}

document.getElementById("testBtn").addEventListener("click",testSend);
</script>
</body>
</html>